var windmobileApp=angular.module("windmobile",["ui.router","windmobile.services","windmobile.controllers"],["$interpolateProvider",function(t){t.startSymbol("[["),t.endSymbol("]]")}]).config(["$locationProvider","$stateProvider","$urlRouterProvider",function(t,e,a){t.html5Mode(!0),e.state("map",{url:"/map",templateUrl:"/static/web/templates/map.html",controller:"MapController as main"}).state("map.detail",{url:"/:stationId",views:{detailView:{templateUrl:"/static/web/templates/detail.html",controller:"DetailController as detail"}}}).state("list",{url:"/list",templateUrl:"/static/web/templates/list.html",controller:"ListController as main"}).state("list.detail",{url:"/:stationId",views:{detailView:{templateUrl:"/static/web/templates/detail.html",controller:"DetailController as detail"}}}),a.otherwise("/map")}]).run(["$rootScope",function(t){Highcharts.setOptions({global:{useUTC:!1},chart:{backgroundColor:null,resetZoomButton:{theme:{fill:"none",stroke:"#ddd",style:{color:"#8d8d8d"}}}},legend:{enabled:!1},plotOptions:{series:{animation:!1,states:{hover:{enabled:!1}}}},rangeSelector:{inputEnabled:!1,buttons:[{type:"day",count:5,text:"5d"},{type:"day",count:2,text:"2d"},{type:"day",count:1,text:"1d"},{type:"hour",count:12,text:"12h"},{type:"hour",count:6,text:"6h"}],selected:4,buttonTheme:{width:35,fill:"none",stroke:"none","stroke-width":0,r:8,style:{color:"#8d8d8d"},states:{hover:{fill:"none",style:{color:"#ddd"}},select:{fill:"none",style:{color:"#ddd"}},disabled:{style:{color:"#666"}}}}}}),t.$on("$stateChangeSuccess",function(e,a,i,r,l){t.controller=a.name.split(".")[0]})}]).directive("wdmWindMiniChart",function(){return{restrict:"C",link:function(t,e,a){var i=100,r=40,l=Snap(e[0]);t.$watch(e.attr("data-scope-watch"),function(t,a){if(e.find(".wdm-minichart").remove(),t&&t.data){for(var n=t.data,o=[],d=[],s=n.length-1;s>=0;s--)o.push(n[s]._id),d.push(n[s]["w-avg"]);var c=Math.min.apply(null,o),h=Math.max.apply(null,o),m=Math.min.apply(null,d),p=Math.max.apply(null,d);if(!c||!h||0>=m&&0>=p)return;var u,f=i/(h-c);u=0===m?0:5;for(var b=(r-u)/(p-m),v=[0,r],s=0;s<o.length-1;s++){var w=(o[s]-c)*f,y=r-u-(d[s]-m)*b,g=(o[s+1]-c)*f,C=r-u-(d[s+1]-m)*b;v.push(w,y,g,C)}v.push(i,r);var x=l.polygon(v);x.attr({"class":"wdm-minichart",fill:"#333"}),v.splice(0,2),v.splice(-2,2);var W=l.polyline(v);W.attr({"class":"wdm-minichart wdm-minichart-line",fill:"none"})}})}}}).directive("wdmWindDirection",function(){return{restrict:"C",link:function(t,e,a){var i=100,r=100,l=Math.min(i,r)/2,n=9,o=Snap(e[0]),d=l-1,s=o.circle(i/2,r/2,d);s.attr({stroke:"#8D8D8D",strokeWidth:1});for(var c=["N","NE","E","SE","S","SW","W","NW"],h=l-n/2-6,m=0,p=0;p<c.length;p++){var u=(m+90)*(Math.PI/180),f=i/2-Math.cos(u)*h,b=r/2-Math.sin(u)*h,v=o.text(f,b,c[p]);v=v.attr({fill:"#8D8D8D","font-size":n,"alignment-baseline":"inherit"}),m+=45}t.$watch(e.attr("data-scope-watch"),function(t,a){if(e.find(".wdm-direction").remove(),t&&t.data)for(var l=t.data,n=i/2,s=i/2,c=0,h=l.length-1;h>=0;h--){var m=l[h]["w-dir"];c+=d/l.length;var p=(m+90)*(Math.PI/180),u=i/2-Math.cos(p)*c,f=r/2-Math.sin(p)*c,b=o.line(n,s,u,f);b.attr({"class":"wdm-direction wdm-direction-line"}),n=u,s=f}})}}}).directive("wdmWindChart",["utils",function(t){return{restrict:"C",link:function(e,a,i){e.$watch(a.attr("data-scope-watch"),function(e){if(e){for(var i={name:"windAvg",type:"areaspline",lineWidth:1,lineColor:"#676700",color:"#333",marker:{enabled:!1},data:[]},r={},l={name:"windMax",type:"spline",color:"#676700",lineWidth:1,marker:{enabled:!1},dataLabels:{enabled:!0,formatter:function(){return t.getWindDirectionLabel(["N","NE","E","SE","S","SW","W","NW"],r[this.key])},color:"#666",style:{textShadow:!1}},data:[]},n=e.length,o=n-1;o>=0;o--){var d=1e3*e[o]._id;l.data.push([d,e[o]["w-max"]]),i.data.push([d,e[o]["w-avg"]]),r[d]=e[o]["w-dir"]}$(a).highcharts("StockChart",{tooltip:{enabled:!1,crosshairs:!1},navigator:{enabled:!1},scrollbar:{enabled:!1},xAxis:{type:"datetime",lineColor:"#8d8d8d"},yAxis:{gridLineWidth:.5,gridLineColor:"#555",labels:{format:"{value} kmh",style:{color:"#7d7d00",fontSize:"9px"}}},series:[i,l]})}})}}}]).directive("wdmAirChart",function(){return{restrict:"C",link:function(t,e,a){t.$watch(e.attr("data-scope-watch"),function(t){if(t){for(var a={name:"temperature",type:"spline",color:"#891f30",lineWidth:1,marker:{enabled:!1},data:[]},i={name:"humidity",type:"spline",color:"#264a68",lineWidth:1,marker:{enabled:!1},yAxis:1,data:[]},r={name:"rain",type:"column",borderColor:"#444",borderWidth:.5,color:"rgba(30, 30, 30, 0.4)",marker:{enabled:!1},yAxis:2,data:[]},l=t.length,n=l-1;n>=0;n--){var o=1e3*t[n]._id;a.data.push([o,t[n].temp]),i.data.push([o,t[n].hum]),r.data.push([o,t[n].rain])}$(e).highcharts("StockChart",{tooltip:{enabled:!1,crosshairs:!1},navigator:{enabled:!1},scrollbar:{enabled:!1},xAxis:{type:"datetime",lineColor:"#8d8d8d"},yAxis:[{gridLineWidth:.5,gridLineColor:"#555",labels:{format:"{value} Â°C",style:{color:"#c72d46",fontSize:"9px"}}},{opposite:!1,gridLineWidth:0,labels:{format:"{value} %",style:{color:"#3b71a0",fontSize:"9px"}}},{gridLineWidth:0,labels:{enabled:!1}}],series:[r,a,i]})}})}}});